<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>MOL File Analyzer</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="style.css" rel="stylesheet"/>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  </script>
</head>
<body>
  <div class="modal fade" id="cookieDialog" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">üç™ Cookie Requirements</h5>
        </div>
        <div class="modal-body">
          <p>This website requires third-party cookies to maintain your session. Please enable cookies in your browser settings for proper functionality.</p>
          <div class="accordion" id="cookieHelp">
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#browserHelp">
                  How to enable cookies
                </button>
              </h2>
              <div id="browserHelp" class="accordion-collapse collapse">
                <div class="accordion-body">
                  <strong>Chrome:</strong>
                  <ol>
                    <li>Settings > Privacy and security > Cookies and other site data</li>
                    <li>Enable "Allow third-party cookies"</li>
                  </ol>
                  <strong>Firefox:</strong>
                  <ol>
                    <li>Preferences > Privacy & Security</li>
                    <li>Under "Enhanced Tracking Protection", select Custom</li>
                    <li>Uncheck "Cookies"</li>
                  </ol>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="kValueDialog">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Reverse Degree Parameter</h5>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <div class="text-center mb-3">
              \[
              f(k) = 
              \begin{cases} 
              \Delta(M) - \deg(v) + k, & \text{if } k \leq \deg(v) \\ 
              \Delta(M), & \text{if } (\Delta(M) - \deg(v) + k) \equiv 0 \ (\mathrm{mod}\ \Delta(M)) \\ 
              (\Delta(M) - \deg(v) + k)\ \mathrm{mod}\ \Delta(M), & \text{otherwise}
              \end{cases}
              \]
            </div>
            <div class="text-center small text-muted mt-2">
              where \(\Delta(M)\) is the maximum degree of the molecule
            </div>
            <div class="d-flex justify-content-center align-items-center gap-2 mt-3">
              <label class="form-label mb-0">Enter \( k \) value:</label>
              <input type="number" id="kInput" class="form-control" min="1" value="1" required style="max-width: 120px;">
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary" id="confirmK">Confirm</button>
        </div>
      </div>
    </div>
  </div>

  <div class="container my-5">
    <h1 class="text-center mb-4">MOL File Analyzer</h1>

    <!-- Mode Selector -->
    <div class="text-center mb-3">
      <div class="btn-group" role="group">
        <input type="radio" class="btn-check" name="mode" id="mode-degree" value="degree" checked>
        <label class="btn btn-outline-secondary" for="mode-degree">Degree</label>
        <input type="radio" class="btn-check" name="mode" id="mode-degreesum" value="degreesum">
        <label class="btn btn-outline-secondary" for="mode-degreesum">Degree Sum</label>
        <input type="radio" class="btn-check" name="mode" id="mode-reverse" value="reverse_degree">
        <label class="btn btn-outline-secondary" for="mode-reverse">Reverse Degree</label>
        <input type="radio" class="btn-check" name="mode" id="mode-scaled-face-degree" value="scaled_face_degree">
        <label class="btn btn-outline-secondary" for="mode-scaled-face-degree">Scaled Face Degree</label>
        <input type="radio" class="btn-check" name="mode" id="mode-scaled-face-degreesum" value="scaled_face_degree_sum">
        <label class="btn btn-outline-secondary" for="mode-scaled-face-degreesum">Scaled Face Degree Sum</label>
      </div>
    </div>

    <!-- File Upload & Results -->
    <div class="card shadow mb-4"><div class="card-body">
      <div id="drop-zone" class="drop-zone">
        <input type="file" id="file-input" multiple accept=".mol" hidden/>
        <div class="text-center">
          <p>Drag &amp; drop .mol files here or</p>
          <button id="choose-btn" class="btn btn-primary">Choose Files</button>
          <button id="calculate-btn" class="btn btn-success ms-2" disabled>Calculate</button>
        </div>
        <div id="file-list" class="mt-2 text-center"></div>
      </div>
    </div></div>

    <!-- Error Card - Removed text-info class -->
    <div class="card shadow d-none" id="error-card">
      <div class="card-body text-center">
        <div id="error-message" class="p-4"></div>
      </div>
    </div>

    <div class="card shadow d-none" id="results-card">
      <div class="card-body">
        <h5 id="results-title" class="mb-3">Analysis Results</h5>
        <div class="table-responsive">
          <table class="table table-striped">
            <thead id="table-head"></thead>
            <tbody id="results-body"></tbody>
          </table>
        </div>
      </div>
    </div>

    <div id="admin-panel" class="card shadow mt-4 d-none">
      <div class="card-body">
        <h5 class="card-title">Admin Controls</h5>
        <div class="input-group mb-3">
          <input type="email" id="reset-email" class="form-control" placeholder="Enter email to reset">
          <button class="btn btn-danger" onclick="resetUserUsage()">Reset Usage</button>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="script.js"></script>
</body>
</html>